
URL=https://api.getastra.com/webhooks/integrations/ci-cd
status_code=$(curl -s -o response.txt -w "%{http_code}" --user-agent "Astra Pentest Trigger Script/1.0" --header "Content-Type: application/json" --request POST --data "{\"accessToken\":\"$ASTRA_ACCESS_TOKEN\",\"projectId\":\"$ASTRA_PROJECT_ID\", \"mode\":\"$ASTRA_AUDIT_MODE\"}" $URL)
if [[ "$status_code" == "200" ]] ; then
  echo "✅ Astra pentest was successfully started."
  cat response.txt
else
  echo "⛔ Failed to start pentest."
  exit 1
fi
